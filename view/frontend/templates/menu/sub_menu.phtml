<?php /** @var \Snowdog\Menu\Block\Menu $block */ ?>
<?php
$menuClass = $block->getMenu()->getCssClass();
$parentNode = $block->getParentNode();
$level = $block->getLevel();
?>
<ul class="<?= $menuClass ?>__inner-list <?= $menuClass ?>__inner-list--level<?= $level ?>" data-menu="menu-<?= $parentNode->getNodeId() ?>">
    <?php if ($block->isViewAllLinkAllowed($parentNode->getType())): ?>
        <li class="<?= $menuClass ?>__inner-item <?= $menuClass ?>__inner-item--all <?= $menuClass ?>__inner-item--level<?= $level ?>">
            <?php echo $block->renderViewAllLink($parentNode) ?>
        </li>
    <?php endif ?>
    <?php foreach ($block->getSubmenuNodes() as $node): ?>
        <?php
            $childrenLevel = $node->getLevel() + 1;
            $children = $this->getNodes($childrenLevel, $node);
            $node->setIsParent((bool) $children);
            $parentClass = $children ? ' ' . $menuClass . '__inner-item--parent' : '';
            $additionalClasses = $node->getClasses() ? ' ' . $node->getClasses() : '';
            $itemClasses = $parentClass . $additionalClasses;
        ?>
        <li class="<?= $menuClass ?>__inner-item <?= $menuClass ?>__inner-item--level<?= $level ?><?= $itemClasses ?>">
            <?php echo $block->renderMenuNode($node) ?>
            <?php echo $block->renderSubmenu($children, $node, $childrenLevel) ?>
        </li>
    <?php endforeach ?>
</ul>
